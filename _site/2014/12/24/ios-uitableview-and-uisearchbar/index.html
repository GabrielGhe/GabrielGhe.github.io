<!-- Overview -->

<h3>Overview</h3>

<p>While working on an iOS app, I needed to have a TableView that was searchable. After looking it up, I found out that
I could use a Table View and add a Search Bar and Search Display.</p>

<!-- Controls -->

<h3>Controls</h3>

<p>TableView will display the data, we just have to supply the functions that tell the table view what to show.</p>

<p><img src="/assets/themes/images/1.png" alt="TableView"></p>

<p>The Search Bar doesn&#39;t do anything except alert us when the search query was changed... We have to implement
the search functionality ourselves. The search display is the dropdown that appears with suggestions once you type something
in the search bar.</p>

<p><img src="/assets/themes/images/2.png" alt="Search Display"></p>

<!-- Directions -->

<h3>Directions</h3>

<p>First we drag and drop a UIViewController to our storyboard.
Then we drag and drop a Table View inside that ViewController and a Search Bar and Search Display above the TableView.</p>

<p>Note: Search Bar and Search Display is 1 control.</p>

<p>Now we need the implementation. Create a file that is a subclass of UIViewController and add the following protocols.</p>

<!-- Code -->

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="lineno">1</span> <span class="k">class</span> <span class="nl">YourViewController</span><span class="p">:</span> <span class="bp">UIViewController</span><span class="p">,</span> <span class="bp">UITableViewDataSource</span><span class="p">,</span> <span class="bp">UITableViewDelegate</span><span class="p">,</span> <span class="bp">UISearchBarDelegate</span><span class="p">,</span> <span class="bp">UISearchDisplayDelegate</span></code></pre></div>

<!-- END Code -->

<p>We have to implement the following functions now.</p>

<!-- Code -->

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="lineno"> 1</span> <span class="c1">// How many rows to display</span>
<span class="lineno"> 2</span> <span class="k">func</span> <span class="n">tableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nl">section</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="c1">// What to display for a particular row</span>
<span class="lineno"> 5</span> <span class="k">func</span> <span class="n">tableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nl">indexPath</span><span class="p">:</span> <span class="bp">NSIndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">UITableViewCell</span>
<span class="lineno"> 6</span> 
<span class="lineno"> 7</span> <span class="c1">// How many sections (only 1 in our case)</span>
<span class="lineno"> 8</span> <span class="k">func</span> <span class="n">numberOfSectionsInTableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span> <span class="p">{</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span> <span class="c1">// the searchString has changed, we have to update our array</span>
<span class="lineno">11</span> <span class="k">func</span> <span class="n">searchDisplayController</span><span class="p">(</span><span class="nl">controller</span><span class="p">:</span> <span class="bp">UISearchDisplayController</span><span class="p">,</span> <span class="n">shouldReloadTableForSearchString</span> <span class="nl">searchString</span><span class="p">:</span> <span class="n">String</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> 
<span class="lineno">12</span> 
<span class="lineno">13</span> <span class="c1">// the searchString has changed, we have to update our array</span>
<span class="lineno">14</span> <span class="k">func</span> <span class="n">searchDisplayController</span><span class="p">(</span><span class="nl">controller</span><span class="p">:</span> <span class="bp">UISearchDisplayController</span><span class="o">!</span><span class="p">,</span> <span class="n">shouldReloadTableForSearchScope</span> <span class="nl">searchOption</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span></code></pre></div>

<!-- END Code -->

<!-- TableView functions -->

<p><br/><br/>
<h3>TableView functions</h3></p>

<!-- Code -->

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="lineno"> 1</span> <span class="k">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nl">section</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span> <span class="p">{</span>
<span class="lineno"> 2</span>   <span class="k">if</span> <span class="p">(</span><span class="n">tableView</span> <span class="o">==</span> <span class="nb">self</span><span class="p">.</span><span class="n">searchDisplayController</span><span class="o">?</span><span class="p">.</span><span class="n">searchResultsTableView</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 3</span>       <span class="k">return</span> <span class="n">searchResults</span><span class="p">.</span><span class="n">count</span>
<span class="lineno"> 4</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 5</span>       <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="n">count</span>
<span class="lineno"> 6</span>   <span class="p">}</span>
<span class="lineno"> 7</span> <span class="p">}</span>
<span class="lineno"> 8</span> 
<span class="lineno"> 9</span> <span class="k">func</span> <span class="n">tableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nl">indexPath</span><span class="p">:</span> <span class="bp">NSIndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">UITableViewCell</span> <span class="p">{</span>
<span class="lineno">10</span>   <span class="k">let</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">myTableView</span><span class="p">.</span><span class="n">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="s">&quot;cell&quot;</span><span class="p">)</span> <span class="kt">as</span> <span class="bp">UITableViewCell</span>
<span class="lineno">11</span>         
<span class="lineno">12</span>   <span class="k">if</span> <span class="p">(</span><span class="n">tableView</span> <span class="o">==</span> <span class="nb">self</span><span class="p">.</span><span class="n">searchDisplayController</span><span class="o">?</span><span class="p">.</span><span class="n">searchResultsTableView</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">13</span>       <span class="n">cell</span><span class="p">.</span><span class="n">textLabel</span><span class="o">?</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">searchResults</span><span class="p">[</span><span class="n">indexPath</span><span class="p">.</span><span class="n">row</span><span class="p">]</span>
<span class="lineno">14</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">15</span>       <span class="n">cell</span><span class="p">.</span><span class="n">textLabel</span><span class="o">?</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indexPath</span><span class="p">.</span><span class="n">row</span><span class="p">]</span>
<span class="lineno">16</span>   <span class="p">}</span>
<span class="lineno">17</span>   <span class="k">return</span> <span class="n">cell</span>
<span class="lineno">18</span> <span class="p">}</span>
<span class="lineno">19</span> 
<span class="lineno">20</span> <span class="k">func</span> <span class="n">numberOfSectionsInTableView</span><span class="p">(</span><span class="nl">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span> <span class="p">{</span>
<span class="lineno">21</span>   <span class="k">return</span> <span class="mi">1</span>
<span class="lineno">22</span> <span class="p">}</span></code></pre></div>

<!-- END Code -->

<p>There are 2 important things to note. </p>

<ol>
<li><p>On line <strong>2</strong> and <strong>12</strong>, we&#39;re checking if the tableView that is calling
this function is the searchDisplay tableView or not. We need to check to be able to return the right data.</p></li>
<li><p>On line <strong>10</strong>, we&#39;re using myTableView. The searchDisplay TableView doesn&#39;t actually have a prototype cell so we&#39;re using
the one from our main tableView.</p></li>
</ol>

<!-- SearchBar functions -->

<p><br/><br/>
<h3>SearchBar functions</h3></p>

<!-- Code -->

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="lineno"> 1</span> <span class="k">func</span> <span class="nf">searchDisplayController</span><span class="p">(</span><span class="nl">controller</span><span class="p">:</span> <span class="bp">UISearchDisplayController</span><span class="p">,</span> <span class="n">shouldReloadTableForSearchString</span> <span class="nl">searchString</span><span class="p">:</span> <span class="n">String</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="p">{</span>
<span class="lineno"> 2</span>   <span class="n">filterContentForSearchText</span><span class="p">(</span><span class="n">searchString</span><span class="p">)</span>
<span class="lineno"> 3</span>   <span class="k">return</span> <span class="nb">true</span>
<span class="lineno"> 4</span> <span class="p">}</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="k">func</span> <span class="n">searchDisplayController</span><span class="p">(</span><span class="nl">controller</span><span class="p">:</span> <span class="bp">UISearchDisplayController</span><span class="o">!</span><span class="p">,</span> <span class="n">shouldReloadTableForSearchScope</span> <span class="nl">searchOption</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="p">{</span>
<span class="lineno"> 7</span>   <span class="n">filterContentForSearchText</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">searchDisplayController</span><span class="o">!</span><span class="p">.</span><span class="n">searchBar</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="lineno"> 8</span>   <span class="k">return</span> <span class="nb">true</span>
<span class="lineno"> 9</span> <span class="p">}</span>
<span class="lineno">10</span> 
<span class="lineno">11</span> <span class="k">func</span> <span class="n">filterContentForSearchText</span><span class="p">(</span><span class="nl">searchText</span><span class="p">:</span><span class="n">String</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">12</span>     <span class="k">let</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">reduce</span><span class="p">([],</span> <span class="nl">combine</span><span class="p">:</span> <span class="o">+</span><span class="p">)</span> <span class="c1">// to flatten array</span>
<span class="lineno">13</span>     <span class="n">searchResults</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">filter</span> <span class="p">{</span>
<span class="lineno">14</span>         <span class="k">var</span> <span class="n">ret</span> <span class="o">=</span> <span class="nb">false</span>
<span class="lineno">15</span>         <span class="k">if</span> <span class="err">$</span><span class="mf">0.</span><span class="n">lowercaseString</span><span class="p">.</span><span class="n">rangeOfString</span><span class="p">(</span><span class="n">searchText</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">nil</span> <span class="p">{</span>
<span class="lineno">16</span>             <span class="n">ret</span> <span class="o">=</span> <span class="nb">true</span>
<span class="lineno">17</span>         <span class="p">}</span>
<span class="lineno">18</span>         <span class="k">return</span> <span class="n">ret</span>
<span class="lineno">19</span>     <span class="p">}</span>
<span class="lineno">20</span> <span class="p">}</span></code></pre></div>

<!-- END Code -->
